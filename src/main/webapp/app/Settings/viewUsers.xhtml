<?xml version="1.0" encoding="UTF-8"?>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/JSP_Servlet/XHtml.xhtml to edit this template
-->
<!DOCTYPE html>

<ui:composition template="/WEB-INF/template2.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="jakarta.faces.facelets">

    <ui:define name="metadata">
        <f:metadata>
            <f:viewAction action="#{viewUsers.setupBreadcrumb}" />
        </f:metadata>
    </ui:define>

    <ui:define name="title">System User</ui:define>

    <ui:define name ="content">

        <!-- Main Content -->
        <div class="main-content">
            <div class="user-management-container">
                <h:form id="userForm">
                    <div style="display: flex; justify-content: space-between">
                        <div class="page-header">
                            <h1 class="page-title">
                                <i class="pi pi-users"></i>
                                User Management
                            </h1>
                            <p class="page-subtitle">Manage system users, roles, and status</p>
                        </div>
                        <div style="margin-top: 50px;">
                            <p:commandButton value="Export to PDF" 
                                             icon="pi pi-file-pdf" 
                                             styleClass="ui-button-success"
                                             action="#{viewUsers.export()}"
                                             ajax="false"/>  
                        </div>
                    </div>
                </h:form>

                <h:form id="userManagementForm">
                    <p:growl id="messages" widgetVar="userGrowl" showSummary="false" showDetail="true" life="6000" globalOnly="false" />

                    <!-- Filter Cards Section -->
                    <h:panelGroup id="filterCards" layout="block" styleClass="filter-cards">
                        <p:commandLink styleClass="filter-card #{viewUsers.filterType == 'ALL' ? 'active' : ''}" 
                                       action="#{viewUsers.applyFilter('ALL')}" 
                                       process="@this"
                                       update="usersDataTable filterCards">
                            <div class="filter-icon all-users">
                                <i class="pi pi-users"></i>
                            </div>
                            <div class="filter-info">
                                <div class="filter-count">#{viewUsers.totalUsers}</div>
                                <div class="filter-label">All Users</div>
                            </div>
                        </p:commandLink>

                        <p:commandLink styleClass="filter-card #{viewUsers.filterType == 'ACTIVE' ? 'active' : ''}" 
                                       action="#{viewUsers.applyFilter('ACTIVE')}" 
                                       process="@this"
                                       update="usersDataTable filterCards">
                            <div class="filter-icon active-users">
                                <i class="pi pi-check-circle"></i>
                            </div>
                            <div class="filter-info">
                                <div class="filter-count">#{viewUsers.activeUsers}</div>
                                <div class="filter-label">Active Users</div>
                            </div>
                        </p:commandLink>

                        <p:commandLink styleClass="filter-card #{viewUsers.filterType == 'INACTIVE' ? 'active' : ''}" 
                                       action="#{viewUsers.applyFilter('INACTIVE')}" 
                                       process="@this"
                                       update="usersDataTable filterCards">
                            <div class="filter-icon inactive-users">
                                <i class="pi pi-times-circle"></i>
                            </div>
                            <div class="filter-info">
                                <div class="filter-count">#{viewUsers.inactiveUsers}</div>
                                <div class="filter-label">Inactive Users</div>
                            </div>
                        </p:commandLink>

                    </h:panelGroup>

                    <div class="datatable-container">
                        <p:dataTable id="usersDataTable" 
                                     value="#{viewUsers.filteredUsers}" 
                                     var="user"
                                     paginator="true" 
                                     rows="10"
                                     paginatorPosition="bottom"
                                     paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                     currentPageReportTemplate="Showing {startRecord} to {endRecord} of {totalRecords} users"
                                     rowsPerPageTemplate="10,20,50,100"
                                     globalFilterFunction="#{viewUsers.globalFilterFunction}"
                                     emptyMessage="No users found matching your criteria"
                                     sortMode="multiple"
                                     allowUnsorting="true"
                                     styleClass="modern-datatable"
                                     rowStyleClass="datatable-row"
                                     widgetVar="usersTable">

                            <f:facet name="header">
                                <div class="datatable-header">
                                    <div class="datatable-title">
                                        <i class="pi pi-list"></i>
                                        <span>Users Directory</span>
                                    </div>
                                    <div class="datatable-controls">
                                        <p:inputText id="globalFilter" 
                                                     onkeyup="PF('usersTable').filter()" 

                                                     placeholder="Search users..."
                                                     styleClass="search-input">
                                            <i class="pi pi-search search-icon"></i>
                                        </p:inputText>
                                    </div>
                                </div>
                            </f:facet>

                            <!-- Avatar Column -->
                            <p:column headerText="User" sortBy="#{user.username}" styleClass="avatar-column">
                                <div class="user-cell">

                                    <div class="user-cell-info">
                                        <div class="user-cell-name">#{user.username}</div>
                                        <div class="user-cell-email">#{user.email}</div>
                                    </div>
                                </div>
                            </p:column>

                            <!-- National ID Column -->
                            <p:column headerText="National ID" sortBy="#{user.ghanaCardNumber}" styleClass="id-column">
                                <div class="id-display">
                                    <span>#{user.ghanaCardNumber}</span>
                                </div>
                            </p:column>

                            <!-- Role Column -->
                            <p:column headerText="Role" sortBy="#{user.userRole.userRolename}" styleClass="role-column">
                                <span class="role-badge role-#{user.userRole != null ? user.userRole.userRolename.toLowerCase() : 'none'}">
                                    #{user.userRole != null ? user.userRole.userRolename : 'No Role'}
                                </span>
                            </p:column>

                            <!-- Status Column -->
                            <p:column headerText="Status" sortBy="#{user.status}" styleClass="status-column">
                                <span class="status-badge status-#{user.status.name().toLowerCase()}">
                                    <i class="pi #{user.status.name() == 'ACTIVE' ? 'pi-check-circle' : 'pi-times-circle'}"></i>
                                    #{user.status.name()}
                                </span>
                            </p:column>

                            <!-- Actions Column -->
                            <p:column headerText="Actions" styleClass="actions-column" exportable="false">
                                <div class="table-actions">
                                    <p:commandButton icon="pi pi-pencil"
                                                     title="Edit User"
                                                     styleClass="table-action-btn edit-action"
                                                     action="#{viewUsers.openEditDialog(user)}"
                                                     update="editUserForm:editUserDialog"
                                                     oncomplete="PF('editUserDialog').show()" />

                                    <p:commandButton icon="pi pi-trash"
                                                     title="Delete User"
                                                     styleClass="table-action-btn delete-action"
                                                     action="#{viewUsers.prepareDeleteUser(user)}"
                                                     update="deleteUserForm:deleteUserDialog"
                                                     oncomplete="PF('deleteUserDialog').show()" />

                                    <p:commandButton icon="pi pi-eye"
                                                     title="View Permissions"
                                                     styleClass="table-action-btn view-action"
                                                     action="#{viewUsers.viewUserPermissions(user)}"
                                                     update="userManagementForm:permissionsDialog"
                                                     oncomplete="PF('permissionsDialog').show()" />
                                </div>
                            </p:column>
                        </p:dataTable>

                    </div>

                    <!-- Permissions Dialog -->
                    <p:dialog id="permissionsDialog" 
                              header="User Permissions" 
                              widgetVar="permissionsDialog" 
                              modal="true" 
                              width="600"
                              styleClass="permissions-dialog">
                        <div id="permissionsDialogContent">
                            <div class="permissions-header">
                                <div class="user-info-dialog">
                                    <i class="pi pi-user"></i>
                                    <div>
                                        <h4>#{viewUsers.selectedUser.username}</h4>
                                        <span>Role: #{viewUsers.selectedUser.userRole != null ? viewUsers.selectedUser.userRole.userRolename : 'No Role'}</span>
                                    </div>
                                </div>
                            </div>

                            <div class="permissions-list">
                                <ui:repeat value="#{viewUsers.selectedUserPermissions}" var="permission">
                                    <div class="permission-item">
                                        <i class="pi pi-check permission-icon"></i>
                                        <div class="permission-details">
                                            <span class="permission-name">#{permission.displayName}</span>
                                            <!--                                            <span class="permission-desc">#-{permission.pagePath}</span>-->
                                        </div>
                                    </div>
                                </ui:repeat>

                                <h:panelGroup rendered="#{empty viewUsers.selectedUserPermissions}">
                                    <div class="no-permissions">
                                        <i class="pi pi-exclamation-triangle"></i>
                                        <span>No permissions assigned</span>
                                    </div>
                                </h:panelGroup>
                            </div>
                        </div>
                    </p:dialog>
                </h:form>    
            </div>

            <!-- Edit User Dialog Form (Separate form for edit dialog) -->
            <h:form id="editUserForm">
                <p:dialog id="editUserDialog" 
                          header="Edit User" 
                          widgetVar="editUserDialog" 
                          modal="true" 
                          width="500"
                          styleClass="edit-user-dialog">

                    <div class="edit-dialog-content">
                        <div class="user-info">
                            <div class="user-avatar">
                                #{viewUsers.selectedUser != null ? viewUsers.getUserInitials(viewUsers.selectedUser) : ''}
                            </div>
                            <div>
                                <h4>#{viewUsers.selectedUser.username}</h4>
                                <span>#{viewUsers.selectedUser.email}</span>
                            </div>
                        </div>

                        <!-- ROLE SELECTION -->
                        <div class="form-group">
                            <label class="form-label">
                                <i class="pi pi-shield"></i>
                                System Role:
                            </label>
                            <p:selectOneMenu value="#{viewUsers.selectedUser.userRole}" 
                                             styleClass="modern-select"
                                             filter="true"
                                             filterMatchMode="contains"
                                             converter="systemUserRoleConverter">
                                <f:selectItem itemLabel="Select Role..." itemValue="#{null}"  noSelectionOption="true"/>
                                <f:selectItems value="#{viewUsers.allSystemRoles}"
                                               var="role"
                                               itemLabel="#{role.userRolename}"
                                               itemValue="#{role}" />
                            </p:selectOneMenu>
                        </div>

                        <!-- STATUS SELECTION -->
                        <div class="form-group">
                            <label class="form-label">
                                <i class="pi pi-info-circle"></i>
                                Status:
                            </label>
                            <p:selectOneRadio value="#{viewUsers.selectedUser.status}" 
                                              styleClass="status-radio"
                                              layout="responsive"
                                              columns="2">
                                <f:selectItem itemLabel="Active" itemValue="ACTIVE"  />
                                <f:selectItem itemLabel="Inactive" itemValue="INACTIVE" />
                            </p:selectOneRadio>
                        </div>

                        <p:commandLink value="Reset Password" update="editUserForm:resetDialog"
                                       oncomplete="PF('editUserDialog').hide(); PF('resetDialog').show();"/>
                    </div>

                    <f:facet name="footer">
                        <div class="dialog-footer">
                            <p:commandButton value="Save Changes" 
                                             icon="pi pi-save"
                                             styleClass="modern-btn primary-btn"
                                             action="#{viewUsers.updateUserRole()}"
                                             update="userManagementForm:messages :userManagementForm:usersDataTable :userManagementForm:filterCards"
                                             oncomplete="PF('editUserDialog').hide()">
                            </p:commandButton>

                            <p:commandButton value="Cancel" 
                                             icon="pi pi-times"
                                             styleClass="modern-btn secondary-btn"
                                             update="@form"
                                             oncomplete="PF('editUserDialog').hide()" />
                        </div>
                    </f:facet>
                </p:dialog> 

                <!-- Confirm Reset-->
                <p:dialog id="resetDialog" 
                          header="Confirm Reset" 
                          widgetVar="resetDialog" 
                          modal="true" 
                          width="450"
                          styleClass="delete-user-dialog">
                    <div class="delete-dialog-content">
                        <div class="delete-warning">
                            <i class="pi pi-exclamation-triangle warning-icon"></i>
                            <div class="warning-text">
                                <h4>Reset User Password</h4>
                                <p>Are you sure you want to reset password for this user?</p>
                            </div>
                        </div>

                        <div class="user-info-delete">
                            <div class="user-avatar-delete">
                                #{viewUsers.selectedUser != null ? viewUsers.getUserInitials(viewUsers.selectedUser) : ''}
                            </div>
                            <div class="user-details-delete">
                                <div class="username-delete">#{viewUsers.selectedUser.username}</div>
                                <div class="email-delete">#{viewUsers.selectedUser.email}</div>
                                <div class="role-delete">
                                    Role: #{viewUsers.selectedUser.userRole != null ? viewUsers.selectedUser.userRole.userRolename : 'No Role'}
                                </div>
                            </div>
                        </div>

                        <div class="delete-warning-message">
                            <i class="pi pi-info-circle"></i>
                            <span>This action cannot be undone.</span>
                        </div>
                    </div>

                    <f:facet name="footer">
                        <div class="dialog-footer">
                            <p:commandButton value="Reset" 
                                             icon="pi pi-spinner"
                                             styleClass="modern-btn danger-btn"
                                             action="#{viewUsers.resetPassword()}"
                                             update=":userManagementForm:messages :userManagementForm:usersDataTable :userManagementForm:filterCards"
                                             oncomplete="PF('resetDialog').hide()"
                                             >
                            </p:commandButton>

                            <p:commandButton value="Cancel" 
                                             icon="pi pi-times"
                                             styleClass="modern-btn secondary-btn"
                                             oncomplete="PF('resetDialog').hide()" />
                        </div>
                    </f:facet>


                </p:dialog>
            </h:form>

            <!-- Delete User Dialog Form (New separate form for delete confirmation) -->
            <h:form id="deleteUserForm">
                <p:dialog id="deleteUserDialog" 
                          header="Confirm Deletion" 
                          widgetVar="deleteUserDialog" 
                          modal="true" 
                          width="450"
                          styleClass="delete-user-dialog">
                    <div class="delete-dialog-content">
                        <div class="delete-warning">
                            <i class="pi pi-exclamation-triangle warning-icon"></i>
                            <div class="warning-text">
                                <h4>Delete User Account</h4>
                                <p>Are you sure you want to permanently delete this user?</p>
                            </div>
                        </div>

                        <div class="user-info-delete">
                            <div class="user-avatar-delete">
                                #{viewUsers.selectedUser != null ? viewUsers.getUserInitials(viewUsers.selectedUser) : ''}
                            </div>
                            <div class="user-details-delete">
                                <div class="username-delete">#{viewUsers.selectedUser.username}</div>
                                <div class="email-delete">#{viewUsers.selectedUser.email}</div>
                                <div class="role-delete">
                                    Role: #{viewUsers.selectedUser.userRole != null ? viewUsers.selectedUser.userRole.userRolename : 'No Role'}
                                </div>
                            </div>
                        </div>

                        <div class="delete-warning-message">
                            <i class="pi pi-info-circle"></i>
                            <span>This action cannot be undone.</span>
                        </div>
                    </div>

                    <f:facet name="footer">
                        <div class="dialog-footer">
                            <p:commandButton value="Delete User" 
                                             icon="pi pi-trash"
                                             styleClass="modern-btn danger-btn"
                                             action="#{viewUsers.confirmDeleteUser()}"
                                             update="userManagementForm:messages :userManagementForm:usersDataTable :userManagementForm:filterCards"
                                             oncomplete="PF('deleteUserDialog').hide()">
                            </p:commandButton>

                            <p:commandButton value="Cancel" 
                                             icon="pi pi-times"
                                             styleClass="modern-btn secondary-btn"
                                             type="button"
                                             onclick="PF('deleteUserDialog').hide()" />
                        </div>
                    </f:facet>
                </p:dialog>
            </h:form>



            <style>
                /* CSS Variables for Consistent Theming */
                :root {
                    --primary-color: #667eea;
                    --primary-hover: #764ba2;
                    --success-color: #10b981;
                    --success-hover: #059669;
                    --danger-color: #ef4444;
                    --danger-hover: #dc2626;
                    --warning-color: #f59e0b;
                    --info-color: #3b82f6;
                    --gray-50: #f9fafb;
                    --gray-100: #f3f4f6;
                    --gray-200: #e5e7eb;
                    --gray-300: #d1d5db;
                    --gray-400: #9ca3af;
                    --gray-500: #6b7280;
                    --gray-600: #4b5563;
                    --gray-700: #374151;
                    --gray-800: #1f2937;
                    --gray-900: #111827;
                    --border-radius: 8px;
                    --border-radius-lg: 12px;
                    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
                    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
                    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
                    --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                }

                /* Main Container */
                .user-management-container {
                    background: var(--gray-50);
                    max-width: 1400px;
                    margin: 0 auto;
                }

                /* Page Header */
                .page-header {
                    text-align: start;
                    margin-bottom: 2rem;
                }

                .page-title {
                    font-size: 2.5rem;
                    font-weight: 700;
                    margin-bottom: 0.5rem;
                    color: var(--gray-800);
                    display: flex;
                    align-items: start;
                    justify-content: start;
                    gap: 1rem;
                }

                .page-title i {
                    color: var(--primary-color);
                    font-size: 2.25rem;
                }

                .page-subtitle {
                    font-size: 1.1rem;
                    color: var(--gray-600);
                    font-weight: 400;
                    margin: 0;
                }

                /* Filter Cards */
                .filter-cards {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
                    gap: 1.5rem;
                    margin-bottom: 2rem;
                }

                .filter-card {
                    background: white;
                    border-radius: var(--border-radius-lg);
                    padding: 1.5rem;
                    box-shadow: var(--shadow-md);
                    border: 2px solid transparent;
                    cursor: pointer;
                    transition: var(--transition);
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                }

                .filter-card:hover {
                    transform: translateY(-2px);
                    box-shadow: var(--shadow-lg);
                }

                .filter-card.active {
                    background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
                }

                .filter-icon {
                    width: 4rem;
                    height: 4rem;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.5rem;
                    color: white;
                }

                .filter-icon.all-users {
                    background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
                }

                .filter-icon.active-users {
                    background: linear-gradient(135deg, var(--success-color), var(--success-hover));
                }

                .filter-icon.inactive-users {
                    background: linear-gradient(135deg, var(--danger-color), var(--danger-hover));
                }

                .filter-info {
                    flex: 1;
                }

                .filter-count {
                    font-size: 2rem;
                    font-weight: 700;
                    color: var(--gray-800);
                    line-height: 1;
                }

                .filter-label {
                    font-size: 0.875rem;
                    color: var(--gray-600);
                    font-weight: 500;
                    text-transform: uppercase;
                    letter-spacing: 0.025em;
                }

                /* DataTable Container */
                .datatable-container {
                    background: white;
                    border-radius: var(--border-radius-lg);
                    box-shadow: var(--shadow-lg);
                    overflow: hidden;
                }

                /* DataTable Header */
                .datatable-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 1.5rem;
                    background: linear-gradient(135deg, var(--gray-50), white);
                    border-bottom: 1px solid var(--gray-200);
                }

                .datatable-title {
                    display: flex;
                    align-items: center;
                    gap: 0.75rem;
                    font-size: 1.25rem;
                    font-weight: 600;
                    color: var(--gray-800);
                }

                .datatable-title i {
                    color: var(--primary-color);
                    font-size: 1.5rem;
                }

                .datatable-controls {
                    position: relative;
                }

                .search-input {
                    padding: 0.75rem 2.5rem 0.75rem 1rem !important;
                    border: 2px solid var(--gray-200) !important;
                    border-radius: var(--border-radius) !important;
                    font-size: 0.875rem !important;
                    transition: var(--transition) !important;
                    background: white !important;
                    width: 300px !important;
                }

                .search-input:focus {
                    outline: none !important;
                    border-color: var(--primary-color) !important;
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
                }

                .search-icon {
                    position: absolute;
                    right: 1rem;
                    top: 50%;
                    transform: translateY(-50%);
                    color: var(--gray-400);
                    pointer-events: none;
                }

                /* DataTable Styling */
                .modern-datatable .ui-datatable-header {
                    background: none !important;
                    border: none !important;
                    padding: 0 !important;
                }

                .modern-datatable .ui-datatable-thead > tr > th {
                    background: var(--gray-100) !important;
                    border: none !important;
                    padding: 1rem !important;
                    font-weight: 600 !important;
                    color: var(--gray-700) !important;
                    font-size: 0.875rem !important;
                    text-transform: uppercase !important;
                    letter-spacing: 0.025em !important;
                }

                .modern-datatable .ui-datatable-tbody > tr > td {
                    border: none !important;
                    border-bottom: 1px solid var(--gray-100) !important;
                    padding: 1rem !important;
                    vertical-align: middle !important;
                }

                .datatable-row:hover {
                    background: var(--gray-50) !important;
                }

                /* User Cell Styling */
                .user-cell {
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                }

                .user-avatar-small {
                    width: 40px;
                    height: 40px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 1rem;
                    font-weight: bold;
                    text-transform: uppercase;
                    flex-shrink: 0;
                }

                .user-cell-info {
                    flex: 1;
                }

                .user-cell-name {
                    font-weight: 600;
                    color: var(--gray-800);
                    margin-bottom: 0.25rem;
                }

                .user-cell-email {
                    font-size: 0.875rem;
                    color: var(--gray-500);
                }

                /* ID Display */
                .id-display {
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                    font-size: 0.875rem;
                    color: var(--gray-600);
                    font-weight: bold;
                }

                .id-display i {
                    color: var(--primary-color);
                }

                /* Status and Role Badges */
                .status-badge, .role-badge {
                    padding: 0.375rem 0.75rem;
                    border-radius: 9999px;
                    font-size: 0.75rem;
                    font-weight: 500;
                    text-transform: uppercase;
                    letter-spacing: 0.025em;
                    display: inline-flex;
                    align-items: center;
                    gap: 0.375rem;
                }

                .status-active {
                    background: #d1fae5;
                    color: #065f46;
                    border: 1px solid #a7f3d0;
                }

                .status-inactive {
                    background: #fee2e2;
                    color: #991b1b;
                    border: 1px solid #fecaca;
                }

                .status-pending_password_change{
                    background: #98dcf2;
                    color: #070549;
                    border: 2px solid #8cafe9;
                }
                .role-none {
                    background: var(--gray-200);
                    color: var(--gray-700);
                }

                /* Table Actions */
                .table-actions {
                    display: flex;
                    gap: 0.5rem;
                    justify-content: center;
                }

                .table-action-btn {
                    width: 2rem !important;
                    height: 2rem !important;
                    border-radius: 50% !important;
                    border: none !important;
                    display: flex !important;
                    align-items: center !important;
                    justify-content: center !important;
                    transition: var(--transition) !important;
                    font-size: 0.75rem !important;
                    cursor: pointer !important;
                }

                .edit-action {
                    background: var(--info-color) !important;
                    color: white !important;
                }

                .edit-action:hover {
                    background: #1d4ed8 !important;
                    transform: scale(1.1) !important;
                }

                .delete-action {
                    background: var(--danger-color) !important;
                    color: white !important;
                }

                .delete-action:hover {
                    background: var(--danger-hover) !important;
                    transform: scale(1.1) !important;
                }

                .view-action {
                    background: var(--warning-color) !important;
                    color: white !important;
                }

                .view-action:hover {
                    background: #d97706 !important;
                    transform: scale(1.1) !important;
                }

                /* Dialog Styling */
                .edit-user-dialog .ui-dialog,
                .delete-user-dialog .ui-dialog,
                .permissions-dialog .ui-dialog {
                    border-radius: var(--border-radius-lg) !important;
                    box-shadow: var(--shadow-lg) !important;
                    border: none !important;
                }

                .edit-dialog-content,
                .delete-dialog-content {
                    padding: 1rem;
                }

                .user-info {
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                    margin-bottom: 2rem;
                    padding: 1rem;
                    background: var(--gray-50);
                    border-radius: var(--border-radius);
                }

                .user-avatar {
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 1.5rem;
                    font-weight: bold;
                    text-transform: uppercase;
                    flex-shrink: 0;
                }

                .user-info h4 {
                    margin: 0 0 0.25rem 0;
                    color: var(--gray-800);
                    font-size: 1.125rem;
                }

                .user-info span {
                    color: var(--gray-600);
                    font-size: 0.875rem;
                }

                /* Delete Dialog Specific Styling */
                .delete-warning {
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                    margin-bottom: 1.5rem;
                    padding: 1rem;
                    background: #fef2f2;
                    border: 1px solid #fecaca;
                    border-radius: var(--border-radius);
                }

                .warning-icon {
                    font-size: 2rem;
                    color: var(--danger-color);
                    flex-shrink: 0;
                }

                .warning-text h4 {
                    margin: 0 0 0.5rem 0;
                    color: var(--gray-800);
                    font-size: 1.125rem;
                }

                .warning-text p {
                    margin: 0;
                    color: var(--gray-600);
                }

                .user-info-delete {
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                    margin-bottom: 1.5rem;
                    padding: 1rem;
                    background: var(--gray-50);
                    border-radius: var(--border-radius);
                }

                .user-avatar-delete {
                    width: 50px;
                    height: 50px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 1.25rem;
                    font-weight: bold;
                    text-transform: uppercase;
                    flex-shrink: 0;
                }

                .user-details-delete {
                    flex: 1;
                }

                .username-delete {
                    font-weight: 600;
                    color: var(--gray-800);
                    font-size: 1rem;
                    margin-bottom: 0.25rem;
                }

                .email-delete {
                    font-size: 0.875rem;
                    color: var(--gray-500);
                    margin-bottom: 0.25rem;
                }

                .role-delete {
                    font-size: 0.75rem;
                    color: var(--gray-600);
                    text-transform: uppercase;
                    font-weight: 500;
                }

                .delete-warning-message {
                    display: flex;
                    align-items: center;
                    gap: 0.75rem;
                    padding: 1rem;
                    background: #fffbeb;
                    border: 1px solid #fed7aa;
                    border-radius: var(--border-radius);
                    font-size: 0.875rem;
                    color: var(--gray-700);
                }

                .delete-warning-message i {
                    color: var(--warning-color);
                    flex-shrink: 0;
                }

                /* Form Styling */
                .form-group {
                    margin-bottom: 1.5rem;
                }

                .form-label {
                    display: block;
                    font-weight: 600;
                    color: var(--gray-700);
                    margin-bottom: 0.5rem;
                    font-size: 0.875rem;
                    display: flex;
                    align-items: center;
                    gap: 0.5rem;
                }

                .form-label i {
                    color: var(--primary-color);
                }

                .modern-select {
                    width: 100% !important;
                    padding: 0.75rem !important;
                    border: 2px solid var(--gray-200) !important;
                    border-radius: var(--border-radius) !important;
                    font-size: 0.875rem !important;
                    transition: var(--transition) !important;
                    background: white !important;
                }

                .modern-select:focus {
                    outline: none !important;
                    border-color: var(--primary-color) !important;
                    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1) !important;
                }

                .status-radio .ui-radiobutton {
                    margin-right: 0.5rem !important;
                }

                /* Button Styling */
                .modern-btn {
                    padding: 0.3rem 0.5rem !important;
                    border-radius: var(--border-radius) !important;
                    font-weight: 600 !important;
                    font-size: 0.875rem !important;
                    transition: var(--transition) !important;
                    border: none !important;
                    cursor: pointer !important;
                    display: inline-flex !important;
                    align-items: center !important;
                    gap: 0.5rem !important;
                }

                .primary-btn {
                    background: linear-gradient(135deg, var(--success-color), var(--success-hover)) !important;
                    color: white !important;
                }

                .primary-btn:hover {
                    background: linear-gradient(135deg, var(--success-hover), #047857) !important;
                    transform: translateY(-1px) !important;
                }

                .secondary-btn {
                    background: white !important;
                    color: var(--gray-700) !important;
                    border: 2px solid var(--gray-300) !important;
                }

                .secondary-btn:hover {
                    background: var(--gray-50) !important;
                    border-color: var(--gray-400) !important;
                }

                .danger-btn {
                    background: linear-gradient(135deg, var(--danger-color), var(--danger-hover)) !important;
                    color: white !important;
                }

                .danger-btn:hover {
                    background: linear-gradient(135deg, var(--danger-hover), #b91c1c) !important;
                    transform: translateY(-1px) !important;
                }

                .dialog-footer {
                    display: flex;
                    justify-content: flex-end;
                    gap: 1rem;
                    padding: 0.3rem 0 0 0;
                }

                /* Permissions Dialog */
                .permissions-header {
                    padding: 1.5rem;
                    border-bottom: 1px solid var(--gray-200);
                    background: var(--gray-50);
                }

                .user-info-dialog {
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                }

                .user-info-dialog i {
                    width: 3rem;
                    height: 3rem;
                    background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
                    color: white;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    font-size: 1.25rem;
                }

                .user-info-dialog h4 {
                    margin: 0;
                    color: var(--gray-800);
                    font-size: 1.125rem;
                }

                .user-info-dialog span {
                    color: var(--gray-600);
                    font-size: 0.875rem;
                }

                .permissions-list {
                    padding: 1.5rem;
                    max-height: 400px;
                    overflow-y: auto;
                }

                .permission-item {
                    display: flex;
                    align-items: center;
                    gap: 1rem;
                    padding: 1rem;
                    margin-bottom: 0.5rem;
                    background: var(--gray-50);
                    border-radius: var(--border-radius);
                    transition: var(--transition);
                }

                .permission-item:hover {
                    background: var(--gray-100);
                }

                .permission-icon {
                    color: var(--success-color);
                    font-size: 1.125rem;
                }

                .permission-details {
                    flex: 1;
                }

                .permission-name {
                    display: block;
                    font-weight: 600;
                    color: var(--gray-800);
                    margin-bottom: 0.25rem;
                }

                .permission-desc {
                    display: block;
                    font-size: 0.875rem;
                    color: var(--gray-600);
                }

                .no-permissions {
                    text-align: center;
                    padding: 2rem;
                    color: var(--gray-500);
                }

                .no-permissions i {
                    font-size: 2rem;
                    margin-bottom: 1rem;
                    display: block;
                }

                /* Pagination Styling */
                .ui-paginator {
                    background: var(--gray-50) !important;
                    border: none !important;
                    padding: 1rem 1.5rem !important;
                    border-top: 1px solid var(--gray-200) !important;
                }

                .ui-paginator .ui-paginator-pages .ui-paginator-page {
                    background: white !important;
                    border: 1px solid var(--gray-300) !important;
                    color: var(--gray-700) !important;
                    margin: 0 0.125rem !important;
                    border-radius: var(--border-radius) !important;
                    min-width: 2.5rem !important;
                    height: 2.5rem !important;
                }

                .ui-paginator .ui-paginator-pages .ui-paginator-page.ui-state-active {
                    background: var(--primary-color) !important;
                    border-color: var(--primary-color) !important;
                    color: white !important;
                }

                .ui-paginator .ui-paginator-pages .ui-paginator-page:hover {
                    background: var(--gray-100) !important;
                }

                .ui-paginator .ui-paginator-first,
                .ui-paginator .ui-paginator-prev,
                .ui-paginator .ui-paginator-next,
                .ui-paginator .ui-paginator-last {
                    background: white !important;
                    border: 1px solid var(--gray-300) !important;
                    color: var(--gray-700) !important;
                    border-radius: var(--border-radius) !important;
                    margin: 0 0.125rem !important;
                    min-width: 2.5rem !important;
                    height: 2.5rem !important;
                }

                .ui-paginator .ui-paginator-first:hover,
                .ui-paginator .ui-paginator-prev:hover,
                .ui-paginator .ui-paginator-next:hover,
                .ui-paginator .ui-paginator-last:hover {
                    background: var(--gray-100) !important;
                }

                /* Responsive Design */
                @media (max-width: 768px) {
                    .user-management-container {
                        padding: 1rem;
                    }

                    .filter-cards {
                        grid-template-columns: 1fr;
                    }

                    .page-title {
                        font-size: 1.875rem;
                        flex-direction: column;
                        gap: 0.5rem;
                    }

                    .datatable-header {
                        flex-direction: column;
                        gap: 1rem;
                    }

                    .search-input {
                        width: 100% !important;
                    }

                    .table-actions {
                        flex-direction: column;
                        gap: 0.25rem;
                    }

                    .dialog-footer {
                        flex-direction: column-reverse;
                    }

                    .modern-btn {
                        width: 100% !important;
                        justify-content: center !important;
                    }
                }

                /* Column Specific Styling */
                .avatar-column {
                    width: 250px !important;
                }

                .id-column {
                    width: 200px !important;
                }

                .role-column {
                    width: 180px !important;
                }

                .status-column {
                    width: 120px !important;
                }

                .actions-column {
                    width: 150px !important;
                    text-align: center !important;
                }

                /* Accessibility */
                @media (prefers-reduced-motion: reduce) {
                    * {
                        animation-duration: 0.01ms !important;
                        animation-iteration-count: 1 !important;
                        transition-duration: 0.01ms !important;
                    }
                }

                .modern-btn:focus,
                .filter-card:focus,
                .table-action-btn:focus {
                    outline: 2px solid var(--primary-color) !important;
                    outline-offset: 2px !important;
                }



            </style>
        </div>
    </ui:define>

</ui:composition>