<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>

<ui:composition template="/WEB-INF/templates.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="jakarta.faces.html"
                xmlns:f="jakarta.faces.core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="jakarta.faces.facelets">
    
    <ui:define name="metadata">
        <f:metadata>
            <f:viewAction action="#{dashboard2.setupBreadcrumb}" />
        </f:metadata>
    </ui:define>

    <ui:define name ="title">System Dashboard</ui:define>
    <ui:define name ="content">
        <!-- Main Content -->
        <div class="main-content" >
            <p:growl widgetVar="fgrowl" id="growl" showSummary= "true" showDetail="true" life="6000" globalOnly="true"/>

            <h1> Dashboard Content </h1>
            <h:form id="dashboardForm" prependId="false">
                <p:tabView>
                    <!-- Admin Dashboard -->
                    <p:tab id="adminTab" title="Admin Dashboard" rendered="#{userSession.checkAdmin()}" >

                        <div class="dashboard">
                            <div class="cards-container">
                                <!-- Card 1 -->
                                <div class="card blue" style="border-left: 6px solid #2BBDD0;">
                                    <h:link outcome="/app/employeeList?faces-redirect=true" styleClass="no-style" >
                                        <div class="card-content">                                       
                                            <div class="card-title">Total Employees</div>
                                            <div class="card-value">#{dashboard2.totalEmployees}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class=" pi pi-users"></i>
                                        </div>
                                    </h:link>
                                </div>

                                <!-- Card 2 -->
                                <div class="card green" style="border-left: 6px solid greenyellow;">
                                    <h:link outcome="/app/EmployeeRoles/createRole?faces-redirect=true" styleClass="no-style" >
                                        <div class="card-content">
                                            <div class="card-title">Total Roles</div>
                                            <div class="card-value">#{dashboard2.totalRoles}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class="fa fa-user-tie"></i>
                                        </div>
                                    </h:link>
                                </div>

                                <!-- Card 3 -->
                                <div class="card orange" style="border-left: 6px solid #E6B262;">
                                    <h:link outcome="/app/Entrances/manageEntrances?faces-redirect=true" styleClass="no-style" >
                                        <div class="card-content">
                                            <div class="card-title">Total Entrances</div>
                                            <div class="card-value">#{dashboard2.totalEntrances}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class="fa-solid fa-door-open"></i>
                                        </div>
                                    </h:link>
                                </div>


                                <!-- Card 4 -->
                                <div class="card red" style="border-left: 6px solid #EA5455;">
                                    <h:link  outcome="/app/Reports/employeeReport?faces-redirect=true"  styleClass="no-style" > <!-- Reports filter for this month -->
                                        <div class="card-content">
                                            <div class="card-title">Onboarded This Month</div>
                                            <div class="card-value">#{dashboard2.employeesOnboardedMonth}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class="fa-regular fa-calendar"></i>
                                        </div>
                                    </h:link>
                                </div>

                                <!-- Card 5 -->
                                <div class="card purple" style="border-left: 6px solid #9A35B6;">
                                    <h:link outcome="/app/Settings/activitylog?faces-redirect=true"  styleClass="no-style" > <!-- Settings Recent logins -->
                                        <div class="card-content">
                                            <div class="card-title">Successful Logins Today</div>
                                            <div class="card-value">#{dashboard2.successfulLoginsToday}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class="fa-regular fa-circle-check"></i>
                                        </div>
                                    </h:link>
                                </div>
                            </div>
                        </div>

                        <p:spacer height="50px"/>
                        <p:panel id="mostAccessOverAll" styleClass="mostAccessed"
                                 header="Most Accessed Entrances This Month" style="border-left: 6px solid #95C0F5;  border-radius: 10px;">
                            <p:lineChart model="#{dashboard2.lineChartModel}" style="height: 300px;" widgetVar="lineChartjs">

                                <!--  AJAX behavior for chart interaction -->
                                <p:ajax event="itemSelect" 
                                        listener="#{dashboard2.onChartItemSelect}"
                                        oncomplete="redirectToHistoryMonitoring()"/>
                            </p:lineChart>

                            <h:outputScript>

                                function redirectToHistoryMonitoring() {
                                console.log(PF('lineChartjs'))
                                //window.location.href = '/STIM/app/Access/historyMonitoring.xhtml';
                                }
                            </h:outputScript>

                        </p:panel>

                        <!--              
                                                <p:panel id="mostAccess" styleClass="mostAccessed"
                                                         header="Top 5 Most Accessed Entrances (Granted Only)" style="border-left: 6px solid #95C0F5;  border-radius: 10px;">
                                                    <p:lineChart id="topEntranceChart" model="#{dashboard2.topEntrancesChartModel}"  style="height: 300px;" />
                                                </p:panel>
                        -->
                        <br/><br/>
                        <h:outputText value="Filter by Entrance: "/>
                        <p:selectOneMenu value="#{dashboard2.selectedEntranceId}">
                            <f:selectItem itemLabel="All Entrances" itemValue="#{null}"/>
                            <f:selectItems value="#{dashboard2.allEntrances}" var="e" itemLabel="#{e.entranceName}" itemValue="#{e.entranceDeviceId}"/>
                            <p:ajax update="dashboardContent" listener="#{dashboard2.updateStats()}" process="@this"/>
                        </p:selectOneMenu>

                        <h:panelGroup id="dashboardContent" layout="block">
                            <p:spacer height="20px"/>
                            <p:panel >
                                <f:facet name="header">
                                    <h:panelGroup layout="block" 
                                                  style="display: flex; align-items: center; justify-content: space-between;">
                                        <h:outputText value="Recent Entrance Access Attempts"/>
                                        <p:button icon="pi pi-arrow-circle-right" styleClass="rounded-button " style="color: white!important;" 
                                                  outcome="/app/Access/historyMonitoring?faces-redirect=true"
                                                  title="See More Details"
                                                  />
                                    </h:panelGroup>
                                </f:facet>
                                <p:dataTable value="#{dashboard2.recentAccessAttempts}" var="log" rowIndexVar="rowIndex"  rowStyleClass="#{rowIndex mod 2 eq 0 ? 'white-row' : 'ash-row'}">  
                                    <p:column headerText="Employee">
                                        <h:outputText value="#{dashboard2.getEmployeeName(log.employee)}"/>
                                    </p:column>
                                    <p:column headerText="GhanaCard No">
                                        <h:outputText value="#{log.employee.ghanaCardNumber}"/>
                                    </p:column>
                                    <p:column headerText="Entrance">
                                        <h:outputText value="#{log.device.entrance.entranceName}"/>
                                    </p:column>
                                    <p:column headerText="Entrance Postion">
                                        <h:outputText value="#{log.device.devicePosition}"/>
                                    </p:column>
                                    <p:column headerText="Result">
                                        <h:outputText value="#{log.result.toUpperCase()}"
                                                      styleClass="#{log.result eq 'GRANTED' ? 'granted-box' : 'denied-box'}" />

                                    </p:column>
                                    <p:column headerText="Time">
                                        <h:outputText value="#{dashboard2.getFormattedTimestamp(log)}">

                                        </h:outputText>
                                    </p:column>
                                </p:dataTable>
                            </p:panel>
                        </h:panelGroup>
                        
                        <p:spacer height="30px"/>
                        <p:panel>
                            
                            <f:facet name="header" >
                                <h:panelGroup layout="block" 
                                              style="display: flex; align-items: center; justify-content: space-between;">
                                    <h:outputText value="Occupant Location Status (Inside / Outside)"/>
                                    <p:button icon="pi pi-arrow-circle-right" styleClass="rounded-button " style="color: white!important;" 
                                              outcome="/app/Entrances/resetEmployeeEntranceState?faces-redirect=true"
                                              title="See More Details"
                                              />
                                </h:panelGroup>
                            </f:facet>
                            <p:dataTable id="currentStateTable"
                                         var="state"
                                         value="#{dashboard2.currentStates}"
                                         paginator="true"
                                         paginatorPosition="bottom"
                                         rows="5"
                                         rowKey="#{state.id}"
                                         styleClass="modern-table">

                                <p:column headerText="Name" sortBy="#{state.employee.firstname}" styleClass="employee">
                                    <i class="pi pi-user" style="color:#6366F1; margin-right:5px"/>
                                    <div style="font-weight: bold">
                                        #{state.employee.firstname} #{state.employee.lastname}
                                    </div>
                                </p:column>

                                <p:column headerText="Ghana Card">
                                    #{state.employee.ghanaCardNumber}
                                </p:column>

                                <p:column headerText="Entrance">
                                    <i class="pi pi-door" style="color:#10B981; margin-right:5px"/> #{state.entrance.entranceName}
                                </p:column>

                                <p:column headerText="State">
                                    <h:panelGroup layout="block" style="display: flex; align-items: center;">
                                        <i class="pi #{state.currentState == 'INSIDE' ? 'pi-arrow-up' : 'pi-arrow-down'}" 
                                           style="color: #{state.currentState == 'INSIDE' ? '#10B981' : '#EF4444'}; margin-right: 6px;" />
                                        <h:outputText value="#{state.currentState}" 
                                                      style="font-weight: 500; color: #{state.currentState == 'INSIDE' ? '#10B981' : '#EF4444'};" />
                                    </h:panelGroup>
                                </p:column>

                                <p:column headerText="Last Updated"> 
                                    <h:outputText value="#{state.formattedLastModifiedDate}" />
                                </p:column>

                                <p:column headerText="Updated By">
                                    #{state.lastUpdatedBy}
                                </p:column>
                            </p:dataTable>
                        </p:panel>


                        <p:spacer height="30px"/>

                        <p:panelGrid columns="2" style="margin-right: 10px!important"> 
                            <p:panel>
                                <f:facet name="header">
                                    <h:panelGroup layout="block" 
                                                  style="display: flex; align-items: center; justify-content: space-between;">
                                        <h:outputText value="Roles With Most Employees"/>
                                        <p:button icon="pi pi-arrow-circle-right" styleClass="rounded-button " style="color: white!important;" 
                                                  outcome="/app/Reports/roleReport?faces-redirect=true"
                                                  title="See More Details on Employee Roles"
                                                  />
                                    </h:panelGroup>
                                </f:facet>
                                <p:pieChart model="#{dashboard2.rolePieChartModelS}" style="height: 400px;" />
                            </p:panel>


                            <p:panel>
                                <f:facet name="header">
                                    <h:panelGroup layout="block" 
                                                  style="display: flex; align-items: center; justify-content: space-between;">
                                        <h:outputText value="Entrance Access Count"/>
                                        <p:button icon="pi pi-arrow-circle-right" styleClass="rounded-button " style="color: white!important;" 
                                                  outcome="/app/Reports/entrancesReport?faces-redirect=true"
                                                  title="See More Details on Entrances"
                                                  />
                                    </h:panelGroup>
                                </f:facet>
                                <div style="display: flex; justify-content: space-between">

                                    <p:outputLabel for="@next">Filter by Entrance</p:outputLabel>
                                    <p:selectOneMenu value="#{dashboard2.entranceId}" >
                                        <f:selectItem itemLabel="All Entrances" itemValue="#{null}" noSelectionOption="true"/>
                                        <f:selectItems value="#{dashboard2.allEntrances}" var="e" itemLabel="#{e.entranceName}" itemValue="#{e.id}"/>
                                        <p:ajax update="entanceAccessChart" listener="#{dashboard2.entranceaccessupdate}" process="@this"/>
                                    </p:selectOneMenu>

                                    <p:outputLabel for="@next">Date Range</p:outputLabel>
                                    <p:datePicker value="#{dashboard2.dateRange}" selectionMode="range"  yearNavigator="true" monthNavigator="true"
                                                  pattern="dd MMM yyyy" styleClass="custom-range">
                                        <p:ajax event="dateSelect" listener="#{dashboard2.entranceaccessupdate}"
                                                update="entanceAccessChart" process="@this" />
                                    </p:datePicker>
                                </div>

                                <p:spacer height="20px"/>

                                <p:outputPanel id="entanceAccessChart" style="align-items:center">

                                    <p:barChart model="#{dashboard2.barChartModelEntrance}" style=" width:50px; height: 400px;" />
                                </p:outputPanel>

                            </p:panel>
                        </p:panelGrid>

                        <p:spacer height="10px"/>

                        <p:panel>
                            <f:facet name="header">
                                <h:panelGroup layout="block" 
                                              style="display: flex; align-items: center; justify-content: space-between;">
                                    <h:outputText value="Recent Employees Added"/>
                                    <p:button icon="pi pi-arrow-circle-right" styleClass="rounded-button " style="color: white!important;" 
                                              outcome="/app/Reports/employeeReport?faces-redirect=true"
                                              title="See More Details on Employees"
                                              />
                                </h:panelGroup>
                            </f:facet>
                            <p:dataTable value="#{dashboard2.recentEmployees}" var="emp">
                                <p:column headerText="Name"><h:outputText value="#{emp.firstname} #{emp.lastname}"/></p:column>
                                <p:column headerText="Date And Time Onboarded">
                                    <h:outputText value="#{emp.createdAt}">
                                        <f:convertDateTime pattern="dd-MM-yyyy HH:mm:ss" />
                                    </h:outputText>
                                </p:column>
                            </p:dataTable>
                        </p:panel>

                        <p:spacer height="30px"/>

                        <p:spacer height="30px"/>
                        <p:panel>
                            <f:facet name="header">
                                <h:panelGroup layout="block" 
                                              style="display: flex; align-items: center; justify-content: space-between;">
                                    <h:outputText value="Recent Activities"/>
                                    <p:button icon="pi pi-arrow-circle-right" styleClass="rounded-button " style="color: white!important;" 
                                              outcome="/app/Settings/activitylog?faces-redirect=true"
                                              title="See More Actitvities"
                                              />
                                </h:panelGroup>
                            </f:facet>
                            <p:dataTable value="#{dashboard2.recentLogins}" var="log">
                                <p:column headerText="User"><h:outputText value="#{log.performedBy.username}"/></p:column>
                                <p:column headerText="Time"><h:outputText value="#{dashboard2.timeString(log.createdOn)}"/></p:column>
                                <p:column headerText="Details"><h:outputText value="#{log.details}"/></p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>

                    <!-- User Dashboard -->
                    <p:tab id="userTab" title="User Dashboard">
                        <div class="dashboard">
                            <div class="cards-container">
                                <div class="card blue" style="border-left: 6px solid #2BBDD0;">
                                    <h:link outcome="/app/employeeList?faces-redirect=true" styleClass="no-style" >
                                        <div class="card-content">                                       
                                            <div class="card-title">Total Employees</div>
                                            <div class="card-value">#{dashboard2.totalEmployees}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class=" pi pi-users"></i>
                                        </div>
                                    </h:link>
                                </div>


                                <!-- Card 2 -->
                                <div class="card green" style="border-left: 6px solid greenyellow;">
                                    <h:link outcome="/app/EmployeeRoles/createRole?faces-redirect=true" styleClass="no-style" >
                                        <div class="card-content">
                                            <div class="card-title">Total Roles</div>
                                            <div class="card-value">#{dashboard2.totalRoles}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class="fa fa-user-tie"></i>
                                        </div>
                                    </h:link>
                                </div>

                                <!-- Card 3 -->
                                <div class="card orange" style="border-left: 6px solid #E6B262;">
                                    <h:link outcome="/app/Entrances/manageEntrances?faces-redirect=true" styleClass="no-style" >
                                        <div class="card-content">
                                            <div class="card-title">Total Entrances</div>
                                            <div class="card-value">#{dashboard2.totalEntrances}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class="fa-solid fa-door-open"></i>
                                        </div>
                                    </h:link>
                                </div>

                                <!-- Card 4 -->
                                <div class="card purple" style="border-left: 6px solid #9A35B6;">
                                    <h:link  styleClass="no-style" > <!-- Settings Recent logins -->
                                        <div class="card-content">
                                            <div class="card-title">Employees Onboarded Today</div>
                                            <div class="card-value">#{dashboard2.employeesUserOnboardedToday}</div>
                                        </div>
                                        <div class="card-icon">
                                            <i class="fa-regular fa-circle-check"></i>
                                        </div>
                                    </h:link>
                                </div>
                            </div>
                        </div>
                       
                        
                        <p:spacer height="50px"/>

                        <p:panel id="activeEntrances" styleClass="mostAccessed"
                                 style="border-left: 6px solid #95C0F5; border-radius: 10px;">

                            <f:facet name="header">
                                <p:outputPanel style="display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">

                                    <h:outputText value="Active Entrances between" style="font-weight: bold;" />

                                    <p:datePicker value="#{dashboard2.startFrom}" pattern="dd-MM-yyyy"
                                                  placeholder="Start Date"
                                                  maxdate="#{dashboard2.endAt}" showIcon="true"
                                                  style="min-width: 140px;" />

                                    <h:outputText value="and" style="font-weight: bold;" />

                                    <p:datePicker value="#{dashboard2.endAt}" pattern="dd-MM-yyyy"
                                                  placeholder="End Date"
                                                  mindate="#{dashboard2.startFrom}" showIcon="true"
                                                  style="min-width: 140px;" />

                                    <p:commandButton value="Filter" icon="pi pi-search"
                                                     actionListener="#{dashboard2.updateMostAccessed}"
                                                     update="activeEntrances"
                                                     styleClass="p-button-sm p-button-outlined p-button-primary"
                                                     style="margin-left: auto;" />
                                </p:outputPanel>
                            </f:facet>

                            <p:lineChart model="#{dashboard2.mostAccessedEntrance}" style="height: 300px;" />
                        </p:panel>


                        <p:spacer height="30px"/>
                        <p:panel header="Recent Activities">
                            <p:dataTable value="#{dashboard2.recentActivities}" var="log">
                                <p:column headerText="User"><h:outputText value="#{log.performedBy.username}"/></p:column>
                                <p:column headerText="Time"><h:outputText value="#{dashboard2.timeString(log.createdOn)}"/></p:column>
                                <p:column headerText="Details"><h:outputText value="#{log.details}"/></p:column>
                            </p:dataTable>
                        </p:panel>

                        <p:spacer height="30px"/>
                        <p:panel header="Your Assigned Entrances" styleClass="mostAccessed" style="border-left: 6px solid #95C0F5; border-radius: 10px;">

                            <h:panelGroup layout="block" styleClass="entrance-grid">
                                <ui:repeat value="#{dashboard2.userAssignedEntrances}" var="entrance">
                                    <p:outputPanel styleClass="pill-wrapper">

                                        <p:commandLink actionListener="#{dashboard2.toggleEntranceExpansion(entrance.id)}"
                                                       update="@form" 
                                                       styleClass="pill-card-link" style="display: block;">

                                            <div class="pill-card">
                                                <div class="pill-content">
                                                    <span class="pill-name">#{entrance.entranceName}</span>
                                                    <i class="pi #{dashboard2.entranceExpansionMap[entrance.id] ? 'pi-chevron-up' : 'pi-chevron-down'} pill-icon"></i>
                                                </div>
                                            </div>
                                        </p:commandLink>

                                        <h:panelGroup rendered="#{dashboard2.entranceExpansionMap[entrance.id]}"
                                                      styleClass="pill-details animated-expand">
                                            <h:panelGrid columns="2" styleClass="pill-details-grid">
                                                <h:outputText value="Location:" />
                                                <h:outputText value="#{entrance.entranceLocation}" />

                                                <h:outputText value="Mode:" />
                                                <h:outputText value="#{entrance.entranceMode}" />
                                            </h:panelGrid>
                                        </h:panelGroup>

                                    </p:outputPanel>
                                </ui:repeat>
                            </h:panelGroup>

                        </p:panel>




                        <p:spacer height="30px"/>
                        <p:panel header="Occupant Location Status (Inside / Outside)">
                            <p:dataTable id="stateTable"
                                         var="state"
                                         value="#{dashboard2.currentStates}"
                                         paginator="true"
                                         paginatorPosition="bottom"
                                         rows="5"
                                         rowKey="#{state.id}"
                                         styleClass="modern-table">

                                <p:column headerText="Name" sortBy="#{state.employee.firstname}" styleClass="employee">
                                    <i class="pi pi-user" style="color:#6366F1; margin-right:5px"/>
                                    <div style="font-weight: bold">
                                        #{state.employee.firstname} #{state.employee.lastname}
                                    </div>
                                </p:column>

                                <p:column headerText="Ghana Card">
                                    #{state.employee.ghanaCardNumber}
                                </p:column>

                                <p:column headerText="Entrance">
                                    <i class="pi pi-door" style="color:#10B981; margin-right:5px"/> #{state.entrance.entranceName}
                                </p:column>

                                <p:column headerText="State">
                                    <h:panelGroup layout="block" style="display: flex; align-items: center;">
                                        <i class="pi #{state.currentState == 'INSIDE' ? 'pi-arrow-up' : 'pi-arrow-down'}" 
                                           style="color: #{state.currentState == 'INSIDE' ? '#10B981' : '#EF4444'}; margin-right: 6px;" />
                                        <h:outputText value="#{state.currentState}" 
                                                      style="font-weight: 500; color: #{state.currentState == 'INSIDE' ? '#10B981' : '#EF4444'};" />
                                    </h:panelGroup>
                                </p:column>

                                <p:column headerText="Last Updated"> 
                                    <h:outputText value="#{state.formattedLastModifiedDate}" />
                                </p:column>

                                <p:column headerText="Updated By">
                                    #{state.lastUpdatedBy}
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                        <p:spacer height="30px"/>

                    </p:tab>
                </p:tabView>
            </h:form>

        </div>
        <script target="head" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
        <!--        <script type="text/javascript">
                // Chart extender function to enable click interactions
                function chartExtender() {
                    this.cfg.axes.xaxis.renderer = $.jqplot.DateAxisRenderer;
                    this.cfg.axes.xaxis.tickOptions = {formatString: '%b %#d'};
                    this.cfg.highlighter = {
                        show: true,
                        sizeAdjust: 7.5,
                        tooltipAxes: 'y',
                        tooltipFormatString: '<b>%s</b> accesses on %s'
                    };
                    this.cfg.cursor = {
                        show: true,
                        zoom: false,
                        showTooltip: false
                    };
                }
                
                // Function to redirect to history monitoring with filters
                function redirectToHistoryMonitoring() {
                    // Get the selected values from hidden inputs
                    var selectedEntrance = document.getElementById('dashboardForm:selectedEntrance').value;
                    var selectedAccessType = document.getElementById('dashboardForm:selectedAccessType').value;
                    var selectedValue = document.getElementById('dashboardForm:selectedValue').value;
                    var dateRangeStart = document.getElementById('dashboardForm:dateRangeStart').value;
                    var dateRangeEnd = document.getElementById('dashboardForm:dateRangeEnd').value;
                    
                    if (selectedEntrance && selectedAccessType) {
                        // Build the redirect URL with parameters
                        var baseUrl = 'historyMonitoring.xhtml';
                        var params = '?faces-redirect=true';
                        params += '&entrance=' + encodeURIComponent(selectedEntrance);
                        params += '&accessType=' + encodeURIComponent(selectedAccessType);
                        params += '&count=' + encodeURIComponent(selectedValue);
                        if (dateRangeStart) params += '&startDate=' + encodeURIComponent(dateRangeStart);
                        if (dateRangeEnd) params += '&endDate=' + encodeURIComponent(dateRangeEnd);
                        params += '&source=dashboard';
                        
                        // Redirect to history monitoring page
                        window.location.href = baseUrl + params;
                    }
                }
                
                // Alternative: Use PrimeFaces remote command for server-side redirect
                function serverRedirect() {
                    PF('redirectCommand')([{name: 'redirect', value: 'true'}]);
                }
                </script>-->
        <style>
            body .ui-panel .ui-panel-titlebar{
                background: #2196f3;
                color: white;

            }
            .ui-panel.mostAccessed .ui-panel-titlebar {
                background-color: #95C0F5;
                color: black;
                border-top-left-radius: 10px;
                border-top-right-radius: 10px;
                /*                background: #99E57A !important;*/
            }
            .dashboard-card {
                background: #f8f9fa;
                border-radius: 8px;
                padding: 20px;
                margin: 10px;
                text-align: center;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .card-title {
                font-size: 1.2em;
                color: #333;
                margin-bottom: 10px;
            }
            .card-value {
                font-size: 2em;
                color: #007bff;
            }

            .chart-container {
                margin: 20px;
                padding: 20px;
            }
            .filter-container {
                margin: 10px;
            }

            .insights{
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
                grid-gap: 24px;
                margin-top: 36px;
                padding: 0px;
            }

            .insights li{
                padding: 24px;
                background: #f6f6f9;
                border-radius: 20px;
                display: flex;
                align-items: center;
                grid-gap: 24px;
            }

            .insights li .bx{
                width: 80px;
                height: 80px;
                border-radius: 10px;
                font-size: 36px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .insights li:nth-child(1) .bx{
                background: #CFE8FF;
                color: #1976D2;
            }

            .insights li:nth-child(2) .bx{
                background: #FFF2C6;
                color: #183153;
            }

            .insights li:nth-child(3) .bx{
                background: #BBF7D0;
                color: #388E3C;
            }

            .insights li:nth-child(4) .bx{
                background: #FECDD3;
                color: #D32F2F;
            }
            .insights li:nth-child(5) .bx{
                background: #cfff00;
                color: #425e9e;
            }

            .insights li:nth-child(6) .bx{
                background: #9A98EA;
                color: #D32F2F;
            }
            .insights li:nth-child(6) .bx{
                background: #9A98EA;
                color: #D32F2F;
            }
            .insights li:nth-child(7) .bx{
                background: #BBF7D0;
                color: #D32F2F;
            }
            .insights li:nth-child(8) .bx{
                background: #BBF7D0;
                color: #D32F2F;
            }
            .insights li:nth-child(9) .bx{
                background: #BBF7D0;
                color: #D32F2F;
            }
            .insights li .info h3{
                font-size: 24px;
                font-weight: 600;
                color: #363949;
            }

            .insights li .info p{
                color: #363949;
            }
            .granted-box {
                background-color: #d4edda; /* light green */
                color: black;
                padding: 4px 8px;
                border-radius: 5px;
                font-weight: bold;
                display: inline-block;
            }

            .denied-box {
                background-color: #dc143c ; /* red */
                color: white;
                padding: 4px 8px;
                border-radius: 5px;
                font-weight: bold;
                display: inline-block;
            }
            .white-row {
                background-color: white !important;
            }

            .ash-row {
                background-color: #f0f0f0 !important;
            }
            .white-row:hover, .ash-row:hover {
                background-color: #dceeff !important;
                cursor: pointer;
            }
            .no-style{
                display: flex;
                justify-content: space-between;
                align-items: center;
                text-decoration: none !important;
                color: inherit !important;
                width: 100%;
                height: 100%;
            }

            .dashboard {
                max-width: 1200px;
                margin-right: 10px;
            }
            .cards-container {
                display: grid;
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 20px;
            }

            .card {
                background-color: white;
                border-radius: 10px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
                padding: 20px;
                display: flex;
                justify-content: space-between;
                align-items: center;
                transition: transform 0.3s ease, box-shadow 0.3s ease;
                height: 120px;
            }

            .card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
            }

            .card-content {
                display: flex;
                flex-direction: column;
            }

            .card-title {
                font-size: 14px;
                color: #666;
                margin-bottom: 8px;
                font-weight: 500;
            }

            .card-value {
                font-size: 28px;
                font-weight: bold;
                color: #333;
            }

            .card-icon {
                font-size: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                width: 50px;
                height: 50px;
                border-radius: 50%;
            }

            /* Card color variations */
            .card.blue .card-icon {
                color: #4c84ff;
                background-color: rgba(76, 132, 255, 0.1);
            }

            .card.green .card-icon {
                color: #2ed47a;
                background-color: rgba(46, 212, 122, 0.1);
            }

            .card.orange .card-icon {
                color: #ff8c00;
                background-color: rgba(255, 140, 0, 0.1);
            }

            .card.red .card-icon {
                color: #f95062;
                background-color: rgba(249, 80, 98, 0.1);
            }

            .card.purple .card-icon {
                color: #8e44ad;
                background-color: rgba(142, 68, 173, 0.1);
            }

            .card.teal .card-icon {
                color: #00a8a8;
                background-color: rgba(0, 168, 168, 0.1);
            }

            .card.pink .card-icon {
                color: #ff4f81;
                background-color: rgba(255, 79, 129, 0.1);
            }

            .card.yellow .card-icon {
                color: #ffa800;
                background-color: rgba(255, 168, 0, 0.1);
            }

            .entrance-grid {
                display: flex;
                flex-wrap: wrap;
                gap: 1rem;
                justify-content: flex-start;
            }

            /*            .pill-wrapper {
                            flex: 1 1 calc(33.333% - 1rem);
                            min-width: 250px;
                        }*/

            .pill-card-link {
                text-decoration: none;
            }

            .pill-card {
                background-color: #b3e5c3;
                color: #fff;
                border-radius: 999px;
                padding: 1px 0.2rem;
                transition: background-color 0.3s ease, transform 0.2s ease;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
                cursor: pointer;
            }

            .pill-card:hover {
                background-color: #81c784;
                transform: translateY(-2px);
            }

            .pill-content {
                display: flex;
                gap: 10px;
                align-items: center;
                font-weight: bold;
                font-size: 1.1rem;
            }

            .pill-icon {
                font-size: 1.2rem;
            }

            .pill-details {
                background: #ffffff;
                color: #333;
                margin-top: 1rem;
                border-radius: 16px;
                padding: 1rem;
                animation: expandDown 0.3s ease-out;
                display: flex;
                justify-content: center;
                align-items: center;

            }

            .pill-details-grid {
                width: 100%;
            }

            @keyframes expandDown {
                0% {
                    opacity: 0;
                    transform: scaleY(0);
                    transform-origin: top;
                }
                100% {
                    opacity: 1;
                    transform: scaleY(1);
                }
            }

        </style>
    </ui:define>
</ui:composition>


